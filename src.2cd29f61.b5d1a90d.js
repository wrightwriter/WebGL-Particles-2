parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"F7Eg":[function(require,module,exports) {
var define;
var e;function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}parcelRequire=function(o,n,r,i){var a,u="function"==typeof parcelRequire&&parcelRequire,s="function"==typeof require&&require;function c(e,t){if(!n[e]){if(!o[e]){var r="function"==typeof parcelRequire&&parcelRequire;if(!t&&r)return r(e,!0);if(u)return u(e,!0);if(s&&"string"==typeof e)return s(e);var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}l.resolve=function(t){return o[e][1][t]||t},l.cache={};var a=n[e]=new c.Module(e);o[e][0].call(a.exports,l,a,a.exports,this)}return n[e].exports;function l(e){return c(l.resolve(e))}}c.isParcelRequire=!0,c.Module=function(e){this.id=e,this.bundle=c,this.exports={}},c.modules=o,c.cache=n,c.parent=u,c.register=function(e,t){o[e]=[function(e,o){o.exports=t},{}]};for(var l=0;l<r.length;l++)try{c(r[l])}catch(o){a||(a=o)}if(r.length){var v=c(r[r.length-1]);"object"==("undefined"==typeof exports?"undefined":t(exports))&&"undefined"!=typeof module?module.exports=v:"function"==typeof e&&e.amd&&e(function(){return v})}if(parcelRequire=c,a)throw a;return c}({D9Nj:[function(e,t,o){},{}],Pp1U:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.m4=void 0;var n={projection:function(e,t,o){return[2/e,0,0,0,0,-2/t,0,0,0,0,2/o,0,-1,1,0,1]},multiply:function(e,t){var o=e[0],n=e[1],r=e[2],i=e[3],a=e[4],u=e[5],s=e[6],c=e[7],l=e[8],v=e[9],f=e[10],m=e[11],p=e[12],_=e[13],d=e[14],E=e[15],y=t[0],T=t[1],R=t[2],g=t[3],x=t[4],h=t[5],A=t[6],b=t[7],S=t[8],P=t[9],U=t[10],F=t[11],M=t[12],L=t[13],D=t[14],C=t[15];return[y*o+T*a+R*l+g*p,y*n+T*u+R*v+g*_,y*r+T*s+R*f+g*d,y*i+T*c+R*m+g*E,x*o+h*a+A*l+b*p,x*n+h*u+A*v+b*_,x*r+h*s+A*f+b*d,x*i+h*c+A*m+b*E,S*o+P*a+U*l+F*p,S*n+P*u+U*v+F*_,S*r+P*s+U*f+F*d,S*i+P*c+U*m+F*E,M*o+L*a+D*l+C*p,M*n+L*u+D*v+C*_,M*r+L*s+D*f+C*d,M*i+L*c+D*m+C*E]},translation:function(e,t,o){return[1,0,0,0,0,1,0,0,0,0,1,0,e,t,o,1]},xRotation:function(e){var t=Math.cos(e),o=Math.sin(e);return[1,0,0,0,0,t,o,0,0,-o,t,0,0,0,0,1]},yRotation:function(e){var t=Math.cos(e),o=Math.sin(e);return[t,0,-o,0,0,1,0,0,o,0,t,0,0,0,0,1]},zRotation:function(e){var t=Math.cos(e),o=Math.sin(e);return[t,o,0,0,-o,t,0,0,0,0,1,0,0,0,0,1]},scaling:function(e,t,o){return[e,0,0,0,0,t,0,0,0,0,o,0,0,0,0,1]},translate:function(e,t,o,r){return n.multiply(e,n.translation(t,o,r))},xRotate:function(e,t){return n.multiply(e,n.xRotation(t))},yRotate:function(e,t){return n.multiply(e,n.yRotation(t))},zRotate:function(e,t){return n.multiply(e,n.zRotation(t))},scale:function(e,t,o,r){return n.multiply(e,n.scaling(t,o,r))},orthographic:function(e,t,o,n,r,i){return[2/(t-e),0,0,0,0,2/(n-o),0,0,0,0,2/(r-i),0,(e+t)/(e-t),(o+n)/(o-n),(r+i)/(r-i),1]}};o.m4=n},{}],vWFK:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.setGeometry=function(e){e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)},o.geometryF=void 0;var n=new Float32Array([0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0]);o.geometryF=n},{}],H9yW:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.setColors=function(e){e.bufferData(e.ARRAY_BUFFER,new Uint8Array([200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,70,200,210,70,200,210,70,200,210,70,200,210,70,200,210,70,200,210,200,200,70,200,200,70,200,200,70,200,200,70,200,200,70,200,200,70,210,100,70,210,100,70,210,100,70,210,100,70,210,100,70,210,100,70,210,160,70,210,160,70,210,160,70,210,160,70,210,160,70,210,160,70,70,180,210,70,180,210,70,180,210,70,180,210,70,180,210,70,180,210,100,70,210,100,70,210,100,70,210,100,70,210,100,70,210,100,70,210,76,210,100,76,210,100,76,210,100,76,210,100,76,210,100,76,210,100,140,210,80,140,210,80,140,210,80,140,210,80,140,210,80,140,210,80,90,130,110,90,130,110,90,130,110,90,130,110,90,130,110,90,130,110,160,160,220,160,160,220,160,160,220,160,160,220,160,160,220,160,160,220]),e.STATIC_DRAW)}},{}],K0yk:[function(e,t,o){"use strict";function n(e){return function(e){if(Array.isArray(e)){for(var t=0,o=new Array(e.length);t<e.length;t++)o[t]=e[t];return o}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function r(e,t,o,n,r){var a=r||i,u=e.createProgram();return t.forEach(function(t){e.attachShader(u,t)}),o&&o.forEach(function(t,o){e.bindAttribLocation(u,n?n[o]:o,t)}),e.linkProgram(u),e.getProgramParameter(u,e.LINK_STATUS)?u:(a("Error in program linking:"+e.getProgramInfoLog(u)),e.deleteProgram(u),null)}function i(e){console.error(e)}Object.defineProperty(o,"__esModule",{value:!0}),o.createProgram=r,o.makeBuffer=function(e,t,o,r,i,a,u,s,c){var l=e.getAttribLocation(o,t),v=e.createBuffer();return e.enableVertexAttribArray(l),e.bindBuffer(e.ARRAY_BUFFER,v),e.bufferData(e.ARRAY_BUFFER,new Float32Array(n(c)),e.STATIC_DRAW),e.vertexAttribPointer(l,r,i,a,u,s),{attributeLocation:l,program:o,properties:{size:r,type:i,normalize:a,stride:u,offset:s}}},o.createProgramFromSources=function(e,t,o,n,i){for(var s=[],c=0;c<t.length;++c)s.push(u(e,t[c],e[a[c]],i));return r(e,s,o,n,i)};var a=["VERTEX_SHADER","FRAGMENT_SHADER"];function u(e,t,o,n){var r=n||i,a=e.createShader(o);if(e.shaderSource(a,t),e.compileShader(a),!e.getShaderParameter(a,e.COMPILE_STATUS))return r("*** Error compiling shader '"+a+"':"+e.getShaderInfoLog(a)),e.deleteShader(a),null}},{}],fTbf:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.NUM_PARTICLES=void 0;o.NUM_PARTICLES=2e3},{}],EgvD:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.computeShaderSource=o.fragmentShaderSource=o.vertexShaderSource=o.fragmentShaderRectangleSource=o.vertexShaderRectangleSource=void 0;var n=e("./vars");o.vertexShaderRectangleSource="#version 310 es\nin vec4 a_position;\n\nuniform mat4 u_matrix;\nuniform float u_fudgeFactor;\nuniform vec2 u_resolution;\n\nout vec4 v_color;\nout vec4 v_position;\n\nvoid main() {\n\n  vec4 position = u_matrix * a_position;\n  float zToDivideBy = 1.;\n  v_color = vec4(1,1,1,1.);\n  v_position = a_position;\n  gl_Position = vec4(position.xy / zToDivideBy, position.zw);\n}\n\n";o.fragmentShaderRectangleSource="#version 310 es\nprecision highp float;\nin vec4 v_color;\nin vec4 v_position;\nout vec4 outColor;\n\nuniform vec2 u_resolution;\nuniform sampler2D u_previousFrame;\nuniform sampler2D u_currFrame;\n\nvoid main() {\n  vec2 uv = v_position.xy/u_resolution;\n\n  uv *= 1.0;\n  uv.y = 1. - uv.y;\n\n  outColor = vec4(0,0,0,1);\n  vec3 previous =  texture(u_previousFrame,uv).xyz;\n  vec3 curr =  texture(u_currFrame,uv).xyz;\n\n  outColor.xyz += previous*1. + curr*1.0;\n}\n";o.vertexShaderSource="#version 310 es\n\n\nin vec4 a_position;\n// in vec4 a_color;\n\n// layout (rgba8, binding = 0) uniform readonly highp image2D u_distTex;\n\nuniform mat4 u_matrix;\nuniform float u_fudgeFactor;\n// uniform sampler2D u_distTex;\nuniform int u_particleId;\nuniform int u_particleCount;\nuniform vec2 u_resolution;\nuniform vec2 u_positionMouse;\n\n// layout (std430, binding = 0) buffer SSBO {\n//   vec3 data[];\n// } ssbo;\nstruct Particle {\n  vec3 position;\n  vec3 velocity;\n};\nlayout (location = 0) in vec3 particle;\nlayout (location = 1) in vec3 particleVelocity;\n\nout vec4 v_color;\n\nvoid main() {\n  float particleCount = float(u_particleCount);\n\n  Particle t = Particle(particle,particleVelocity);\n\n  vec4 position = u_matrix * vec4(0. + t.position.x*u_resolution.x,u_resolution.y-t.position.y*u_resolution.y,1.,1.);\n  // vec4 position = u_matrix * vec4(0. + u_positionMouse.x*u_resolution.x,u_resolution.y-t.position.y*u_resolution.y,1.,1.);\n  \n  float zToDivideBy = 1.;\n  gl_PointSize = 4.0;\n  v_color = vec4(particleVelocity,1.);\n  gl_Position = vec4(position.xy / zToDivideBy, position.zw);\n}\n";o.fragmentShaderSource="#version 310 es\n\nprecision mediump float;\n\nin vec4 v_color;\n\nout vec4 outColor;\n\n\nvoid main() {\n  // outColor = v_color;\n  vec2 uv = 2.*gl_PointCoord - 1.;\n\n  float r = 1.;\n  outColor = vec4(v_color.x,v_color.y,1,1.) * smoothstep(r, r*0.99, length(uv));\n}\n";var r="#version 310 es\n  layout (local_size_x = 1, local_size_y = 1, local_size_z = 1) in;\n\n  struct Particle {\n    vec3 position;\n    vec3 velocity;\n  };\n\n  layout (std430, binding = 0) buffer SSBO {\n    vec3 position[".concat(n.NUM_PARTICLES,"]; // TODO: make this an import\n    vec3 velocity[").concat(n.NUM_PARTICLES,"];\n  } ssbo;\n\n  uniform vec2 u_resolution;\n  uniform vec2 u_positionMouse;\n  uniform float u_mousePressed;\n  uniform int u_particleCount;\n  uniform float u_timeElapsed;\n  uniform float u_avoidance;\n  uniform vec2 u_gravity;\n  \n\n  float r11(float i) {return fract(sin(i*212.12)*124.41);}\n  vec3 r13(float i) {return vec3( r11(i), r11(i*2.4), r11(i*1.57));} \n\n  void main() {\n    ivec2 posGlobal = ivec2(gl_GlobalInvocationID.xy);\n\n    // Particle previous = ssbo.particle[posGlobal.x];\n    // Particle previous = Particle(ssbo.position[posGlobal.x], ssbo.velocity[posGlobal.x]);\n    Particle previous = Particle(ssbo.position[posGlobal.x], ssbo.velocity[posGlobal.x]);\n    Particle next = previous;\n\n    vec2 positionMouse = u_positionMouse ;\n    vec2 directionMouse = normalize(positionMouse - previous.position.xy );\n\n\n    if (u_timeElapsed <=  20.) {\n      // ssbo.position[posGlobal.x] = vec3(0.5,0.5,1);\n      ssbo.position[posGlobal.x] = r13(float(posGlobal.x) + 1.);\n      ssbo.position[posGlobal.x].z = 1.;\n      // ssbo.velocity[posGlobal.x] = vec3(0);\n    } else {\n      // -- bounds -- //\n      if (previous.position.x < 0.) {\n        previous.velocity.x = -1.*abs(previous.velocity.x);\n      }\n      if (previous.position.x > 1.){\n        previous.velocity.x = 1.*abs(previous.velocity.x);\n      }\n      if (previous.position.y < 0.) {\n        previous.velocity.y = -1.*abs(previous.velocity.y);\n      }\n      if (previous.position.y > 1.) {\n        previous.velocity.y = 1.*abs(previous.velocity.y);\n      }\n      \n      // -- mouse -- //\n      if (u_mousePressed == 1.) {\n        previous.velocity.x -= directionMouse.x*0.0001;\n        previous.velocity.y -= directionMouse.y*0.0003;\n      }\n\n\n      \n      // -- avoidance -- //\n      for (int i = 0; i < u_particleCount; i++) {\n        vec3 otherPos = ssbo.position[int(i)];\n        vec3 direction = normalize(otherPos - previous.position);\n        float dis = length(otherPos - previous.position);\n        previous.velocity += direction * exp(-dis*(200. - u_avoidance*190.))*0.0001;\n      }\n\n      // -- vortex -- //\n      float frId = 10.*float(posGlobal.x)/float(u_particleCount);\n      vec2 vortexPos = vec2(sin(frId + u_timeElapsed*0.001), cos(frId + u_timeElapsed*0.001))*0.5 + 0.5;\n      vec2 vortexDir = normalize(vortexPos - previous.position.xy);\n      // previous.velocity.xy -= vortexDir*0.0001;\n      \n\n\n      \n      // -- damping -- //\n      previous.velocity *= 0.99;\n      // -- gravity -- //\n      previous.velocity.xy -= u_gravity*0.0003;\n\n      next.position -= previous.velocity;\n      next.velocity = previous.velocity;\n\n      // -- bounds -- //\n      // if (next.position.y == 0.) {\n      //   next.position.y = abs(next.position.y);        \n      // }\n      // next.position.y = max(next.position.y, 0.);\n      // next.position.xy = max(min(next.position.xy, vec2(1.)), vec2(0));\n\n      ssbo.position[posGlobal.x] = next.position;\n      ssbo.velocity[posGlobal.x] = next.velocity;\n    }\n\n  }\n\n\n");o.computeShaderSource=r},{"./vars":"fTbf"}],H99C:[function(e,t,o){"use strict";e("./styles.css");var n=e("./m4.js"),r=(e("./setGeometry"),e("./setColors"),e("./utils")),i=e("./vars"),a=e("./shaders.js");function u(e){return e*Math.PI/180}function s(e){var t=function(e,t){var o=function(e,t){var o=(t=t||e.target).getBoundingClientRect();return{x:e.clientX-o.left,y:e.clientY-o.top}}(e,t=t||e.target);return o.x=o.x*t.width/t.clientWidth,o.y=o.y*t.height/t.clientHeight,o}(e,this.gl.canvas),o=t.x/this.gl.canvas.width*2-1,n=t.y/this.gl.canvas.height*-2+1;this.state.positionMouse={x:o,y:n}}document.getElementById("app").innerHTML="<h1>Hello Vanilla!</h1>",window.addEventListener("DOMContentLoaded",function(){var e=this,t=document.getElementById("canvas"),o=(t.width,t.height,t.getContext("webgl2-compute",{antialias:!1}));if(this.gl=o,o){var c=webglUtils.createProgramFromSources(o,[a.vertexShaderSource,a.fragmentShaderSource]),l=webglUtils.createProgramFromSources(o,[a.vertexShaderRectangleSource,a.fragmentShaderRectangleSource]),v=o.createShader(o.COMPUTE_SHADER);o.shaderSource(v,a.computeShaderSource),o.compileShader(v),o.getShaderParameter(v,o.COMPILE_STATUS)||(console.log(o.getShaderInfoLog(v)),console.log("error compiling shader"));var f=o.createProgram();o.attachShader(f,v),o.linkProgram(f),o.getProgramParameter(f,o.LINK_STATUS)||console.log("error linking shader");var m=o.createBuffer();o.bindBuffer(o.SHADER_STORAGE_BUFFER,m),o.bufferData(o.SHADER_STORAGE_BUFFER,new Float32Array(6*i.NUM_PARTICLES),o.DYNAMIC_COPY),o.bindBufferBase(o.SHADER_STORAGE_BUFFER,0,m);var p=o.canvas.clientWidth,_=o.canvas.clientHeight,d=o.createTexture();o.bindTexture(o.TEXTURE_2D,d),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,p,_,0,o.RGBA,o.UNSIGNED_BYTE,null),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE);var E=o.createFramebuffer();o.bindFramebuffer(o.FRAMEBUFFER,E),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,d,0);var y=o.createTexture();o.bindTexture(o.TEXTURE_2D,y),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,p,_,0,o.RGBA,o.UNSIGNED_BYTE,null),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE);var T=o.createFramebuffer();o.bindFramebuffer(o.FRAMEBUFFER,T),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,y,0);var R=o.createTexture();o.bindTexture(o.TEXTURE_2D,R),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,p,_,0,o.RGBA,o.UNSIGNED_BYTE,null),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT1,o.TEXTURE_2D,R,0),function(e,t){var o=e.getError();o!==e.NO_ERROR&&(console.log("ERROR: SSBO problem"),console.log(o))}(o);var g=o.createVertexArray();o.bindVertexArray(g),(0,r.makeBuffer)(o,"a_position",l,4,o.FLOAT,!1,16,0,new Float32Array([0,o.canvas.clientHeight,0,1,o.canvas.clientWidth,o.canvas.clientHeight,1,1,0,0,1,1,o.canvas.clientWidth,0,1,1]));var x=o.createVertexArray();o.bindVertexArray(x),(0,r.makeBuffer)(o,"a_position",c,1,o.FLOAT,!1,0,0,new Float32Array(i.NUM_PARTICLES)),o.getUniformLocation(c,"u_color");var h=o.getUniformLocation(c,"u_matrix"),A=(o.getUniformLocation(c,"u_fudgeFactor"),o.getAttribLocation(c,"a_color"),[0,0,0]);u(0),u(0),u(0),Math.random(),Math.random(),Math.random(),this.state={gravity:{x:0,y:0},timePrevious:(new Date).getTime(),timeNext:this.timePrevious,timeDelta:0,timeElapsed:0,timeStarted:this.timePrevious,positionMouse:{x:0,y:0},mousePressed:0,avoidance:0,formula:"vec2(sin(frId + u_timeElapsed*0.001), cos(frId + u_timeElapsed*0.001))"};var b=document.querySelector("#formula");b.addEventListener("oninput",function(t){b.innerHTML=t.target.value,e.state.formula=t.target.value,o.shaderSource(v,a.computeShaderSource),o.compileShader(v)}),document.body.onmousedown=function(t){e.state.mousePressed=1},document.body.onmouseup=function(t){e.state.mousePressed=0},window.addEventListener("mousemove",function(t){s.call(e,t)}),P.call(this),setInterval(function(){P.call(e),function(){webglUtils.resizeCanvasToDisplaySize(o.canvas),o.bindFramebuffer(o.FRAMEBUFFER,E),o.viewport(0,0,o.canvas.clientWidth,o.canvas.clientHeight),o.enable(o.CULL_FACE),o.enable(o.DEPTH_TEST),o.enable(o.BLEND),o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA),o.clearColor(0,0,0,1),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),o.bindVertexArray(x);var e=o.canvas.clientWidth,t=o.canvas.clientHeight,r=n.m4.orthographic(0,e,t,0,400,-400);o.bindBuffer(o.ARRAY_BUFFER,m),o.vertexAttribPointer(0,3,o.FLOAT,!1,8,0),o.enableVertexAttribArray(0),o.vertexAttribPointer(1,3,o.FLOAT,!1,8,1*i.NUM_PARTICLES*4),o.enableVertexAttribArray(1),o.useProgram(c),o.uniformMatrix4fv(h,!1,r),o.uniform1i(o.getUniformLocation(c,"u_particleCount"),i.NUM_PARTICLES),o.uniform2fv(o.getUniformLocation(c,"u_resolution"),new Float32Array([o.canvas.clientWidth,o.canvas.clientHeight])),o.uniform2fv(o.getUniformLocation(c,"u_positionMouse"),new Float32Array([this.state.positionMouse.x,this.state.positionMouse.y])),o.drawArrays(o.POINTS,0,i.NUM_PARTICLES)}.call(e),function(){o.bindFramebuffer(o.FRAMEBUFFER,T),o.viewport(0,0,o.canvas.clientWidth,o.canvas.clientHeight),o.clearColor(0,0,0,1),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),o.bindVertexArray(g);var e=o.canvas.clientWidth,t=o.canvas.clientHeight,r=n.m4.orthographic(0,e,t,0,400,-400);1===S?(o.activeTexture(o.TEXTURE1),o.bindTexture(o.TEXTURE_2D,y),o.drawBuffers([o.COLOR_ATTACHMENT1])):(o.activeTexture(o.TEXTURE1),o.bindTexture(o.TEXTURE_2D,R),o.drawBuffers([o.COLOR_ATTACHMENT0])),o.useProgram(l),o.uniform1i(o.getUniformLocation(c,"u_currFrame"),0),o.uniform1i(o.getUniformLocation(c,"u_previousFrame"),1),o.uniformMatrix4fv(o.getUniformLocation(l,"u_matrix"),!1,r),o.uniform1i(o.getUniformLocation(l,"u_particleCount"),i.NUM_PARTICLES),o.uniform2fv(o.getUniformLocation(l,"u_resolution"),new Float32Array([o.canvas.clientWidth,o.canvas.clientHeight])),o.uniform2fv(o.getUniformLocation(l,"u_positionMouse"),new Float32Array([this.state.positionMouse.x,this.state.positionMouse.y])),o.drawArrays(o.TRIANGLE_STRIP,0,20),o.bindFramebuffer(o.READ_FRAMEBUFFER,E),o.bindFramebuffer(o.DRAW_FRAMEBUFFER,null),o.blitFramebuffer(0,0,o.canvas.clientWidth,o.canvas.clientHeight,0,0,o.canvas.clientWidth,o.canvas.clientHeight,o.COLOR_BUFFER_BIT,o.NEAREST),S=1-S,o.bindFramebuffer(o.FRAMEBUFFER,null)}.call(e),e.state.timeNext=(new Date).getTime(),e.state.timeDelta=e.state.timeNext-e.state.timePrevious,e.state.timeElapsed+=e.state.timeDelta,e.state.timePrevious=e.state.timeNext},1),webglLessonsUI.setupSlider("#x",{value:A[0],slide:function(e,t){A[0]=t.value,drawScene()},max:o.canvas.width}),webglLessonsUI.setupSlider("#gravity-x",{value:500,slide:function(t,o){e.state.gravity.x=o.value/1e3-.5},max:1e3}),webglLessonsUI.setupSlider("#gravity-y",{value:500,slide:function(t,o){e.state.gravity.y=o.value/1e3-.5},max:1e3}),webglLessonsUI.setupSlider("#avoidance",{value:0,slide:function(t,o){e.state.avoidance=o.value/1e3},max:1e3});var S=1}function P(){o.useProgram(f),o.uniform2fv(o.getUniformLocation(f,"u_resolution"),new Float32Array([o.canvas.clientWidth,o.canvas.clientHeight])),o.uniform2fv(o.getUniformLocation(f,"u_positionMouse"),new Float32Array([this.state.positionMouse.x,this.state.positionMouse.y])),o.uniform2fv(o.getUniformLocation(f,"u_gravity"),new Float32Array([this.state.gravity.x,this.state.gravity.y])),o.uniform1f(o.getUniformLocation(f,"u_avoidance"),this.state.avoidance),o.uniform1f(o.getUniformLocation(f,"u_mousePressed"),this.state.mousePressed),o.uniform1i(o.getUniformLocation(f,"u_particleCount"),i.NUM_PARTICLES),o.uniform1f(o.getUniformLocation(f,"u_timeElapsed"),this.state.timeElapsed),o.dispatchCompute(i.NUM_PARTICLES,1,1),o.memoryBarrier(o.SHADER_IMAGE_ACCESS_BARRIER_BIT)}})},{"./styles.css":"D9Nj","./m4.js":"Pp1U","./setGeometry":"vWFK","./setColors":"H9yW","./utils":"K0yk","./vars":"fTbf","./shaders.js":"EgvD"}]},{},["H99C"]);
},{}]},{},["F7Eg"], null)
//# sourceMappingURL=src/index.html/src.2cd29f61.b5d1a90d.js.map